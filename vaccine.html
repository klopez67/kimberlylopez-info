<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Data-Driven Insights into Antibody Response: An R-Based Predictive Modeling Project</title>

<script src="site_libs/header-attrs-2.28/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="experience.html">Experience</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Projects
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="vaccine.html">Predicting Flu Severity</a>
    </li>
    <li>
      <a href="SAS_project.html">Risk Factors for Cognitive Decline</a>
    </li>
    <li>
      <a href="projects.html">Breast Cancer Survival Modeling</a>
    </li>
    <li>
      <a href="asthma_project.html">Asthma &amp; Tempature Dashboard</a>
    </li>
    <li>
      <a href="influenza.html">Influenza Agent Based Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">My CV</a>
</li>
<li>
  <a href="mailto:kp2809@cumc.columbia.edu">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/kimberly-palaguachi-lopez2024/">
    <span class="fab fa-linkedin"></span>
     
  </a>
</li>
<li>
  <a href="http://github.com/klopez67/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Data-Driven Insights into Antibody
Response: An R-Based Predictive Modeling Project</h1>

</div>


<style>
body {
    font-family: 'Georgia', serif;
    inline: 1.6;
    margin: 0 20px;
}

h1, h2, h3 {
    font-family: 'Georgia', serif;
    color: #2c3e50;
    margin-bottom: 10px;
}

ul {
    margin-left: 20px;
}

blockquote {
    font-style: italic;
    color: #7f8c8d;
    padding-left: 20px;
    border-left: 5px solid #ecf0f1;
}

.table {
    width: 100%;
    margin: 20px 0;
    border-collapse: collapse;
}

.table th, .table td {
    border: 1px solid #ecf0f1;
    padding: 10px;
    text-align: left;
}

.table th {
    background-color: #f9f9f9;
}
</style>
<div id="introduction" class="section level1">
<h1><strong>Introduction</strong></h1>
<p>This study investigates the influence of clinical predictors on
experience severity of flu status among vaccinated individuals 6 months
post-vaccination. We aim to identify the most superior predictive model
for severity of flu by evaluating and comparing multiple statistical
models. The selected model will help determine which factors
significantly predict the chances of experiencing severe flu based on
individual characteristics.</p>
</div>
<div id="exploratory-data-analysis" class="section level1">
<h1><strong>Exploratory Data Analysis</strong></h1>
<pre class="r"><code>library(patchwork)
library(factoextra)
library(dplyr)
library(tidyverse)
library(vtable)
library(recipes)
library(caret)
library(ggcorrplot)
library(rsample)
library(MASS)
library(ISLR) 
library(glmnet) 
library(corrplot) 
library(ggplot2)
library(plotmo) 
library(ggrepel)
library(car)
library(pROC) 

#data import
dat = read.csv(&quot;vaccine/severe_flu.csv&quot;)
dat = dat[,2:13] #removing id 
# no missing data sum(is.na(dat))

#data cleaning
dat = dat |&gt; 
  mutate(
    gender = factor(gender, levels = c(0, 1), labels = c(&quot;Female&quot;, &quot;Male&quot;)),
    race = factor(race, levels = c(1, 2, 3, 4), labels = c(&quot;White&quot;, &quot;Asian&quot;, &quot;Black&quot;, &quot;Hispanic&quot;)),
    smoking = factor(smoking, levels = c(0, 1, 2), labels = c(&quot;Never&quot;, &quot;Former&quot;, &quot;Current&quot;)),
    diabetes = factor(diabetes, levels = c(0, 1), labels = c(&quot;No&quot;, &quot;Yes&quot;)),
    hypertension = factor(hypertension, levels = c(0, 1), labels = c(&quot;No&quot;, &quot;Yes&quot;)), 
    severe_flu = factor(severe_flu, levels = c(0,1), labels = c(&quot;No&quot;, &quot;Yes&quot;)),
    age = as.numeric(age),
    SBP = as.numeric(SBP),
    LDL = as.numeric(LDL),
    bmi = as.numeric(bmi),
    weight = as.numeric(weight),
    height = as.numeric(height))

#test and training data split 
set.seed(2)

data_split = initial_split(dat, prop = 0.7)

training_data = training(data_split)
testing_data = testing(data_split)</code></pre>
<p>This dataset contains data on 1000 participants (N =1000). There were
no missing data for any of the predictors. Table 1 shows the mean,
standard deviation for each continuous variable and the proportion
across each categorical variable. In the full dataset, there were 75% of
individuals who did not experience severe flu 6-months after vaccination
while 25% did. The distribution of age, SBP, and LDL appear to be
similar across flu severity outcome, while there are some differences in
distribution of weight, height, and bmi across flu severity status
(Figure 1). There also appears to be differences in the distribution of
continuous variables in the training data compared to testing data
(Figure 2). There is evidence of multicollinearity between weight and
bmi with a correlation of 0.71-0.69 across flu severity status (Figure
3). The proportion of individual who experience severe flu across races,
smoking status, diabetes, and hypertension do not differ drastically
(Figure 4). From the PCA – Biplot on centered and scaled data, linear
combinations of continuous variables do not separate the classes well
(Figure 5).</p>
<figure style="text-align: center;">
<figcaption style="font-size: 14px; color: #555; margin-top: 5px;">
Table 1. Summary statistics for participant characteristics
</figcaption>
<p><img src="vaccine/table1.png" style="width:50%; border:none;" alt="" /></p>
</figure>
<p><strong>10-fold cross-validation (CV)</strong> was performed across
all models in the trainControl function from caret package. For each
configuration of tuning parameters, CV randomly split the training data
into 10 equal-sized folds: 9 folds serve as the training set, and the
remaining fold works as the validation set. The summary function was set
to two class summary and class probabilities were computed for the
binary outcome of flu severity. The metric ROC was calculated for each
of the validation set folds, and the average ROC was derived from them.
To optimize model performance, this process was repeated for different
parameter configurations. The model with the highest ROC was chosen as
the best or final model to be evaluated on the test dataset.</p>
<pre class="r"><code>ctrl = trainControl(method = &quot;cv&quot;,
                     number = 10,
                    summaryFunction = twoClassSummary,
                     classProbs = TRUE)</code></pre>
<p><strong>Data Preprocessing</strong> was performed on the training
data to center, scale, and apply the optimal box cox transformation on
numeric predictors through the recipes function. This recipe was
prepared on training data through the prep function, and the bake
function was applied to the new training and testing data using the prep
from the training data.</p>
<pre class="r"><code>rec= recipe(severe_flu ~ ., data = training_data) |&gt;
  step_BoxCox(all_numeric_predictors())|&gt;
  step_center(all_numeric_predictors()) |&gt;
  step_scale(all_numeric_predictors())

# 2. Prepare the recipe on the training data
prep = prep(rec, training = training_data)
trainData_pp = bake(prep,new_data = training_data)
testData_pp = bake(prep, new_data = testing_data)

#PCA
rec_pca= recipe(severe_flu ~ ., data = training_data) |&gt;
  step_BoxCox(all_numeric_predictors())|&gt;
  step_center(all_numeric_predictors()) |&gt;
  step_scale(all_numeric_predictors())|&gt;
  step_pca(num_comp = 5)

prep_pca = prep(rec, training = training_data)
trainData_pca = bake(prep_pca,new_data = training_data)
testData_pca = bake(prep_pca, new_data = testing_data)</code></pre>
<p><strong>Random seed <code>2</code></strong> was set through the
set.seed function to ensure reproducible results. All models were
trained using the caret package which were then compared on training
data performance through resampling. The models all predicted the
outcome ‘severe flu’ status.</p>
<div id="dimension-reduction" class="section level2">
<h2>Dimension Reduction</h2>
<p>Partial least squares investigated the optimal dimension reduction.
Elastic net for regularization and logistic regression as the simpler
model were fit on the training dataset as these methods balance
complexity and simpler models. Since the classes of flu severity were
not separable, SVM Radial Sigma was applied for higher-dimension
non-linear boundary. Ada Boosting was applied to repeatedly fit
classification trees to weighted versions of the training data and
update the weights to better classify previously misclassified
observations.</p>
<div id="partial-least-squares" class="section level3">
<h3>Partial Least Squares</h3>
<p><strong>Partial Least Squares (PLS):</strong> The model was trained
on the tuning grid of components 1:14 as the maximum number of
components in the dataset in a supervised way. Through CV, the optimal
number of components in the final model was 4 which explain the maximum
variance present for the predictor variables (Figure 6).</p>
<pre class="r"><code>set.seed(2)

pls_fit = train(severe_flu~., 
                data = trainData_pp, 
                method = &quot;pls&quot;,
                metric = &quot;ROC&quot;,
                tuneGrid = data.frame(ncomp = 1:14), 
                trControl = ctrl)

ggplot(pls_fit, highlight = TRUE)</code></pre>
<p><img src="vaccine_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
</div>
<div id="regularization" class="section level2">
<h2>Regularization</h2>
<p><strong>Elastic Net:</strong> The selected tuning grid of alpha and
lambda values were expanded through the expand.grid function where a
range of alpha values from 0 to 1 and a sequence of 100 lambda values
from exponential -5:3. The method in train control was set to “glmnet”.
After CV on the preprocessed training data, the final model had an
optimal alpha value of 0 and lambda value of 0.35 (Figure 7). All
variables were kept in the model. Variables such as age, gender: Male,
race: Black, smoking status: Former, and height each had negative
coefficients.</p>
<pre class="r"><code>set.seed(2)

enet.fit = train(severe_flu~., 
                 data = training_data,
                 method = &quot;glmnet&quot;,
                 preProcess = c(&quot;center&quot;, &quot;scale&quot;),
                 metric = &quot;ROC&quot;,
                 tuneGrid = expand.grid(alpha = seq(0, 1, length = 21),
                                        lambda = exp(seq(-5, 5, length = 100))),
                 trControl = ctrl)

#enet.fit$bestTune
#coef(enet.fit$finalModel, enet.fit$bestTune$lambda)


myCol = rainbow(25)
myPar = list(superpose.symbol = list(col = myCol),
              superpose.line = list(col = myCol)) 

#plot(enet.fit, par.settings = myPar, xTrans = log)  

# same logisitc regression on preproccessed data 
enet.fit2 = train(severe_flu~., 
                 data = trainData_pp,
                 method = &quot;glmnet&quot;,
                 metric = &quot;ROC&quot;,
                 tuneGrid = expand.grid(alpha = seq(0, 1, length = 21),
                                        lambda = exp(seq(-5, 3, length = 100))),
                 trControl = ctrl)

#enet.fit2$bestTune
#coef(enet.fit2$finalModel, enet.fit2$bestTune$lambda)</code></pre>
<p>Figure 7. Cross Validation Plot of alpha and lambda for Elastic
Net</p>
<pre class="r"><code>plot(enet.fit2, par.settings = myPar, xTrans = log)</code></pre>
<p><img src="vaccine_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
</div>
<div id="model-training" class="section level1">
<h1><strong>Model Training</strong></h1>
<div id="simple-models" class="section level2">
<h2>Simple Models</h2>
<div id="logistic-regression" class="section level4">
<h4>1.) Logistic Regression</h4>
<p><strong>Logistic Regression:</strong> There is no tuning parameter
for this model, so the 10-fold CV was used for finding the optimal
model. The binomial family distribution was specified in the train
function to perform logistic regression. After CV on the preprocessed
training data, the final model included all predictors with negative
coefficients on the same variable as the elastic net model.</p>
<pre class="r"><code>set.seed(2)

#Logistic regression on ordinary data
log.fit = train(severe_flu~ .,
                data= training_data,
                method = &quot;glm&quot;,
                family = &quot;binomial&quot;,
                preProcess= c(&quot;center&quot;, &quot;scale&quot;),
                metric = &quot;ROC&quot;,
                trControl = ctrl)

#Logistic Regression Model on Preprocessed data 
log.fit2 = train(severe_flu~.,
                data= trainData_pp,
                method = &quot;glm&quot;,
                family = &quot;binomial&quot;,
                metric = &quot;ROC&quot;,
                trControl = ctrl)
#summary(log.fit2$finalModel)
#vif(log.fit2$finalModel)

#Logistic Regression on preprocessed data with PCA 
log.fit3 = train(rec_pca,
                data= training_data,
                method = &quot;glm&quot;,
                family = &quot;binomial&quot;,
                metric = &quot;ROC&quot;,
                trControl = ctrl)</code></pre>
</div>
<div id="lda" class="section level4">
<h4>2.) LDA</h4>
<p><strong>Linear Discriminant Analysis:</strong> LDA was fit using the
train() function with method “lda”. Since LDA does not have any
hyperparameters to tune, no tuning grid was specified and performs
supervised linear dimension reduction by finding a linear combination of
features that best separates the outcome classes. After CV, the two
outcome groups (severe vs. non-severe flu) were not well-separated along
the first linear discriminant (Figure 8).</p>
<pre class="r"><code>x= model.matrix( severe_flu ~ . ,training_data )[,-1]
y = training_data$severe_flu

set.seed(2)

#Model without transformations
model.lda=  train(x,y, 
                  preProcess= c(&quot;center&quot;, &quot;scale&quot;),
                  method = &quot;lda&quot;,
                  metric = &quot;ROC&quot;,
                  trControl = ctrl)

#Model on Preprocessed data 
x_rec= model.matrix( severe_flu ~ . ,trainData_pp )[,-1]
y_rec = trainData_pp$severe_flu

set.seed(2)
model.lda2=  train(x_rec,y_rec, 
                  method = &quot;lda&quot;,
                  metric = &quot;ROC&quot;,
                  trControl = ctrl)</code></pre>
<p>Figure 8. Linear Discriminant Analysis Final model</p>
<pre class="r"><code>plot(model.lda2$finalModel)</code></pre>
<p><img src="vaccine_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
</div>
<div id="advanced-models" class="section level2">
<h2>Advanced Models</h2>
<div id="classification-ada-boosting" class="section level4">
<h4>1.) Classification Ada Boosting</h4>
<p><strong>Ada Boosting:</strong> A tuning grid was created using
expand.grid, varying the number of trees (n.trees = 0.1, 1, 10, 50,
100), interaction depth (1–5), and shrinkage (0.001, 0.005, 0.01, 0.05).
The minimum number of observations in each terminal node was set to the
default value of 10. The default number of individuals in each final
node was used (10). The method was set to “gbm” for boosting and
specification of “adaboost” distribution. After CV, the optimal model
used 50 trees, 1 interaction depth, and a shrinkage of 0.01 (Figure 9).
Variable importance plots indicated that BMI had the strongest influence
on predicting flu severity, followed by weight (coefficient magnitude:
0.97), while other variables contributed very little to the model
(Figure 10).</p>
<p>Figure 9. Cross Validation Plot for Ada Boosting</p>
<pre class="r"><code>gbmA.grid = expand.grid(n.trees = c(0.1,1,10,100,200), 
                        interaction.depth = 1:5,
                        shrinkage = c(0.001,0.005, 0.01, 0.05), 
                        n.minobsinnode = 10)
set.seed(2)

#Ada Boosting on non-scaled data wihout highly correlated variables
gbmA.fit = train(severe_flu ~ . -weight - height, 
                  data= training_data, 
                  tuneGrid = gbmA.grid,
                  trControl = ctrl,
                  method = &quot;gbm&quot;,
                  distribution = &quot;adaboost&quot;,
                  metric = &quot;ROC&quot;,
                  verbose = FALSE) 

#Ada Boosting on Pre processed data
gbmA.fit2 = train(severe_flu ~ ., 
                  data= trainData_pp, 
                  tuneGrid = gbmA.grid,
                  trControl = ctrl,
                  method = &quot;gbm&quot;,
                  distribution = &quot;adaboost&quot;,
                  metric = &quot;ROC&quot;,
                  verbose = FALSE)

ggplot(gbmA.fit2, highlight = TRUE)</code></pre>
<p><img src="vaccine_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre class="r"><code>#summary(gbmA.fit2$finalModel, las = 2, cBars = 19, cex.names = 0.8)</code></pre>
</div>
<div id="svm-radial-sigma" class="section level4">
<h4>3.) SVM Radial Sigma</h4>
<p>Support Vector Machine (SVM) Radial Sigma: This model used the
specified method of “svmRadialSigma”. The hyperparameter grid was
defined with an exponential range of cost (C) values from exp(3) to
exp(7), totaling 25 values, and sigma values from exp(−12) to exp(−4),
totaling 15 values. This expanded grid was selected based on prior
experimentation with the grid, as smaller ranges (e.g., C between exp(0)
and exp(5)) were at the boundaries of the previous grids. After CV, the
optimal model used a cost value of 175.32 and sigma value of
6.041424e-05 (Figure 11).</p>
<pre class="r"><code>suppressMessages(suppressWarnings({
  
#SVM on Preprocessed data
svmr.grid3 = expand.grid(C = exp(seq(3, 7, length = 25)), #originally 0,5 then 5,8 which wasnt good
                         sigma = exp(seq(-12, -4, length = 15)))
set.seed(2)
svmr.fit2 = train(severe_flu ~.,
                 data= trainData_pp, 
                 method = &quot;svmRadialSigma&quot;,
                 metric = &quot;ROC&quot;,
                 tuneGrid= svmr.grid3, 
                 trControl = ctrl)
}))</code></pre>
<pre><code>## maximum number of iterations reached 0.005208606 0.004992195maximum number of iterations reached 0.005462052 0.005205819maximum number of iterations reached 0.003087809 0.002985274maximum number of iterations reached 0.0003971545 0.0003939636maximum number of iterations reached 0.0008936621 0.000876583maximum number of iterations reached 0.002002787 0.001932389maximum number of iterations reached 0.006309195 0.005995589maximum number of iterations reached 0.005124966 0.004885755maximum number of iterations reached 0.00157642 0.001534137maximum number of iterations reached 0.003075869 0.00294876maximum number of iterations reached 0.003659331 0.00350469maximum number of iterations reached 0.003329932 0.003182721maximum number of iterations reached 0.004476812 0.004295861maximum number of iterations reached 0.004298143 0.00413292maximum number of iterations reached 0.000837739 0.000822727maximum number of iterations reached 0.00371372 0.003567828maximum number of iterations reached 0.005335716 0.005111045maximum number of iterations reached 0.005122428 0.004901099maximum number of iterations reached 3.205211e-05 3.201412e-05maximum number of iterations reached 0.001914066 0.001861566maximum number of iterations reached 0.003773138 0.003608274maximum number of iterations reached 0.0001758318 0.0001749963maximum number of iterations reached 0.0001751562 0.0001743977maximum number of iterations reached 0.0006682027 0.0006601563maximum number of iterations reached 0.00144585 0.001411863maximum number of iterations reached 0.005307754 0.005108476maximum number of iterations reached 0.005622187 0.005432914maximum number of iterations reached 0.005278721 0.005078158maximum number of iterations reached 0.005275566 0.005105202maximum number of iterations reached 0.001950908 0.001898735maximum number of iterations reached 0.001614169 0.001570323maximum number of iterations reached 0.004158884 0.003964898maximum number of iterations reached 0.001634106 0.001593119maximum number of iterations reached 0.004849675 0.004623723maximum number of iterations reached 0.0007770318 0.0007668152maximum number of iterations reached 0.0001184462 0.0001180411maximum number of iterations reached 0.000555924 0.000549261maximum number of iterations reached 4.299856e-05 4.293251e-05maximum number of iterations reached 0.004436929 0.004255729maximum number of iterations reached 0.001791975 0.001745209maximum number of iterations reached 0.003849118 0.0037231maximum number of iterations reached 0.005913188 0.005691756maximum number of iterations reached 0.001545424 0.001512665maximum number of iterations reached 0.003533698 0.003442764maximum number of iterations reached 0.002041904 0.002015534maximum number of iterations reached 0.003116781 0.003011506maximum number of iterations reached 0.001859249 0.001802354maximum number of iterations reached 0.0005713618 0.0005651155maximum number of iterations reached 8.898672e-05 8.872546e-05maximum number of iterations reached 0.004975317 0.004820956maximum number of iterations reached 0.004196057 0.004088908maximum number of iterations reached 0.005227566 0.005107111maximum number of iterations reached 0.002562019 0.002532554maximum number of iterations reached 0.002090244 0.002020627maximum number of iterations reached 0.005423201 0.005280968maximum number of iterations reached 0.002761262 0.002701481maximum number of iterations reached 0.005862761 0.005703825maximum number of iterations reached 0.001107328 0.00108835maximum number of iterations reached 0.002274646 0.002235065maximum number of iterations reached 0.002411239 0.002394386maximum number of iterations reached 1.265571e-05 1.264699e-05maximum number of iterations reached 0.00407844 0.00398062maximum number of iterations reached 0.0003352327 0.0003340361maximum number of iterations reached 0.004934965 0.00471368maximum number of iterations reached 0.001594545 0.001553875maximum number of iterations reached 0.004101233 0.003940296maximum number of iterations reached 0.006870348 0.006551473maximum number of iterations reached 0.003025793 0.002922635maximum number of iterations reached 0.001671683 0.001631623maximum number of iterations reached 0.003019538 0.002914645maximum number of iterations reached 0.003280824 0.003148145maximum number of iterations reached 9.753719e-06 9.748018e-06maximum number of iterations reached 0.004549871 0.004372259maximum number of iterations reached 0.002453291 0.002366407maximum number of iterations reached 0.005552775 0.005309351maximum number of iterations reached 0.005290275 0.005083389maximum number of iterations reached 0.0003785745 0.0003755273maximum number of iterations reached 0.002607277 0.002524966maximum number of iterations reached 0.006647863 0.006403387maximum number of iterations reached 0.005266921 0.005107092maximum number of iterations reached 0.004640876 0.004502891maximum number of iterations reached 0.001043881 0.001029023maximum number of iterations reached 0.00420195 0.004063922maximum number of iterations reached 0.005519413 0.005315024maximum number of iterations reached 0.003562163 0.003441732maximum number of iterations reached 0.004504224 0.004334461maximum number of iterations reached 0.007311647 0.006953002maximum number of iterations reached 0.0008053094 0.0007953458maximum number of iterations reached 0.003094174 0.002977441maximum number of iterations reached 0.006462439 0.006197518maximum number of iterations reached 0.006127249 0.005886855maximum number of iterations reached 0.005581602 0.00535402maximum number of iterations reached 9.182388e-05 9.153428e-05maximum number of iterations reached 0.004720605 0.004561483maximum number of iterations reached 0.004267444 0.004137107maximum number of iterations reached 0.005552025 0.005400909maximum number of iterations reached 0.006469822 0.00626666maximum number of iterations reached 0.003703815 0.003595543maximum number of iterations reached 0.001548802 0.001506232maximum number of iterations reached 0.004635096 0.004459542maximum number of iterations reached 0.003399594 0.003263867maximum number of iterations reached 0.002505298 0.00243558maximum number of iterations reached 0.002503709 0.002424508maximum number of iterations reached 0.003501316 0.003374104maximum number of iterations reached 0.005132231 0.004960539maximum number of iterations reached 0.003155746 0.003062531maximum number of iterations reached 0.001907233 0.001866827maximum number of iterations reached 0.002899013 0.002821961maximum number of iterations reached 0.006025479 0.005843021maximum number of iterations reached 0.0001236032 0.000123327maximum number of iterations reached 0.003324784 0.003255003maximum number of iterations reached 0.001861561 0.001835425maximum number of iterations reached 5.489988e-05 5.482128e-05maximum number of iterations reached 0.003841754 0.003707019maximum number of iterations reached 0.0002526969 0.0002510081maximum number of iterations reached 0.002203728 0.00213801maximum number of iterations reached 0.004334906 0.004209016maximum number of iterations reached 0.001095489 0.001076469maximum number of iterations reached 0.00228284 0.002239234maximum number of iterations reached 0.004216965 0.004102901maximum number of iterations reached 0.005035125 0.004882989maximum number of iterations reached 0.005232637 0.005092358maximum number of iterations reached 0.004091361 0.003967854maximum number of iterations reached 0.002969594 0.002901276maximum number of iterations reached 0.00224013 0.002205573maximum number of iterations reached 0.001602516 0.001591056maximum number of iterations reached 0.0003895192 0.0003880867maximum number of iterations reached 0.0001821096 0.0001818189maximum number of iterations reached 6.217345e-05 6.21154e-05maximum number of iterations reached 0.003687793 0.003544943maximum number of iterations reached 2.739369e-05 2.735576e-05maximum number of iterations reached 0.005990229 0.005836141maximum number of iterations reached 0.002818185 0.002746762maximum number of iterations reached 0.004687671 0.004535341maximum number of iterations reached 0.003834422 0.003759597maximum number of iterations reached 0.004263658 0.004192342maximum number of iterations reached 0.0005019099 0.0004977875maximum number of iterations reached 0.001456959 0.001444921maximum number of iterations reached 3.844487e-05 3.83964e-05maximum number of iterations reached 0.002561167 0.002530381maximum number of iterations reached 0.003079859 0.003018854maximum number of iterations reached 0.001322355 0.001305521maximum number of iterations reached 0.0005551341 0.0005524332maximum number of iterations reached 1.606408e-05 1.605315e-05maximum number of iterations reached 9.460881e-06 9.454953e-06maximum number of iterations reached 5.735232e-05 5.729319e-05maximum number of iterations reached 4.24946e-05 4.246191e-05maximum number of iterations reached 2.384957e-05 2.382098e-05maximum number of iterations reached 0.0005934571 0.0005863984maximum number of iterations reached 0.0009525021 0.0009307226maximum number of iterations reached 0.001307611 0.001275655maximum number of iterations reached 0.0008597557 0.0008487591maximum number of iterations reached 0.003063734 0.002947811maximum number of iterations reached 0.002155579 0.002090231maximum number of iterations reached 0.00267662 0.00261751maximum number of iterations reached 0.001828321 0.001769712maximum number of iterations reached 0.003079884 0.002967879maximum number of iterations reached 0.001788764 0.001745006maximum number of iterations reached 0.001941188 0.001878017maximum number of iterations reached 0.0009538558 0.0009339017maximum number of iterations reached 0.00345642 0.003334661maximum number of iterations reached 0.001357549 0.001327176maximum number of iterations reached 0.002007629 0.00194496maximum number of iterations reached 0.0001669741 0.0001662676maximum number of iterations reached 0.003640592 0.003482343maximum number of iterations reached 0.002147952 0.002092529maximum number of iterations reached 0.003029412 0.002925373maximum number of iterations reached 0.0047215 0.004499185maximum number of iterations reached 0.003656533 0.00352766maximum number of iterations reached 0.00200679 0.001957087maximum number of iterations reached 0.001165143 0.001152764maximum number of iterations reached 0.004732081 0.004542529maximum number of iterations reached 0.005591033 0.005406072maximum number of iterations reached 0.002462987 0.002405844maximum number of iterations reached 0.0006497365 0.000643918maximum number of iterations reached 0.0002765418 0.0002747269maximum number of iterations reached 0.002906903 0.002808039maximum number of iterations reached 1.830027e-05 1.828665e-05maximum number of iterations reached 0.001065755 0.001046713maximum number of iterations reached 0.004734942 0.004520756maximum number of iterations reached 0.00150796 0.001473352maximum number of iterations reached 0.005661884 0.005422843maximum number of iterations reached 0.003530737 0.003421456maximum number of iterations reached 6.776367e-05 6.763952e-05maximum number of iterations reached 0.004899789 0.004763257maximum number of iterations reached 0.001307038 0.001289621maximum number of iterations reached 0.001022886 0.001006034maximum number of iterations reached 0.0005231266 0.0005181206maximum number of iterations reached 0.003118475 0.00304315maximum number of iterations reached 0.0001532737 0.0001530064maximum number of iterations reached 0.005424361 0.005242808maximum number of iterations reached 0.0001452625 0.0001449452maximum number of iterations reached 3.06552e-05 3.063258e-05maximum number of iterations reached 0.0001756291 0.0001750884maximum number of iterations reached 1.543387e-05 1.542492e-05maximum number of iterations reached 0.005188792 0.004959352maximum number of iterations reached 0.004844322 0.004628172maximum number of iterations reached 0.005218806 0.005044668maximum number of iterations reached 0.004932981 0.004719434maximum number of iterations reached 0.005372973 0.005186186maximum number of iterations reached 9.5697e-06 9.5642e-06maximum number of iterations reached 0.001855378 0.001793343maximum number of iterations reached 0.004007551 0.003850717maximum number of iterations reached 0.004214939 0.004071179maximum number of iterations reached 0.00465051 0.004470562maximum number of iterations reached 3.658584e-05 3.651353e-05maximum number of iterations reached 0.004403314 0.004252471maximum number of iterations reached 0.003762963 0.003613872maximum number of iterations reached 2.829367e-05 2.825346e-05maximum number of iterations reached 0.0002677479 0.0002653621maximum number of iterations reached 0.006702453 0.006535745maximum number of iterations reached 0.002814102 0.002750122maximum number of iterations reached 0.005216115 0.005083311maximum number of iterations reached 0.003406898 0.003288123maximum number of iterations reached 0.006140338 0.005930865maximum number of iterations reached 0.004536452 0.00440122maximum number of iterations reached 0.004393481 0.00422907maximum number of iterations reached 0.003821836 0.003644299maximum number of iterations reached 0.001361977 0.001327321maximum number of iterations reached 0.002834125 0.002734591maximum number of iterations reached 0.00363658 0.003512993maximum number of iterations reached 0.006144501 0.005892492maximum number of iterations reached 0.005592139 0.005382692maximum number of iterations reached 0.006929836 0.006684355maximum number of iterations reached 0.005776826 0.005563052maximum number of iterations reached 0.005600425 0.005472098maximum number of iterations reached 0.005733126 0.005536327maximum number of iterations reached 0.004698543 0.004541547maximum number of iterations reached 0.005045898 0.004902718maximum number of iterations reached 0.004712446 0.004594201maximum number of iterations reached 0.001037419 0.00101763maximum number of iterations reached 0.001598739 0.001567567maximum number of iterations reached 0.00514174 0.004979612maximum number of iterations reached 0.004817415 0.004647578maximum number of iterations reached 0.001856787 0.001820176maximum number of iterations reached 0.005157336 0.004964845maximum number of iterations reached 0.003673185 0.003522693maximum number of iterations reached 0.001977734 0.001916479maximum number of iterations reached 0.004400014 0.004200682maximum number of iterations reached 0.000653328 0.0006427171maximum number of iterations reached 0.004997288 0.004848954maximum number of iterations reached 0.003544898 0.003425194maximum number of iterations reached 0.005683234 0.005512531maximum number of iterations reached 0.005023273 0.004859092maximum number of iterations reached 0.0003501904 0.0003472521maximum number of iterations reached 0.005358951 0.005227395maximum number of iterations reached 0.005532609 0.005378876maximum number of iterations reached 0.003163956 0.003109351maximum number of iterations reached 0.002087339 0.002032905maximum number of iterations reached 0.005133262 0.005010559maximum number of iterations reached 0.005233413 0.005077316maximum number of iterations reached 0.003615761 0.003521286maximum number of iterations reached 0.003438493 0.003362843maximum number of iterations reached 0.005711019 0.005537952maximum number of iterations reached 0.004983925 0.004831587maximum number of iterations reached 0.003715076 0.003641755maximum number of iterations reached 0.003903196 0.003810931maximum number of iterations reached 0.003014927 0.002960644maximum number of iterations reached 0.0006359622 0.000631653maximum number of iterations reached 0.00487276 0.004748749maximum number of iterations reached 0.005617795 0.005410445maximum number of iterations reached 0.006168335 0.00597987maximum number of iterations reached 0.006264856 0.006022835maximum number of iterations reached 0.00578596 0.005633355maximum number of iterations reached 0.00552344 0.005334691maximum number of iterations reached 0.004920994 0.004809743maximum number of iterations reached 0.004934705 0.004783635maximum number of iterations reached 0.00528179 0.005174584maximum number of iterations reached 0.002351582 0.002306583maximum number of iterations reached 0.003589385 0.003521487maximum number of iterations reached 0.002006825 0.001983721maximum number of iterations reached 3.67302e-05 3.669851e-05maximum number of iterations reached 0.006111011 0.005969356maximum number of iterations reached 0.006014291 0.005796231maximum number of iterations reached 0.006613013 0.00643833maximum number of iterations reached 0.005918808 0.005721738maximum number of iterations reached 0.004625897 0.004489622maximum number of iterations reached 0.003516244 0.003453848maximum number of iterations reached 0.003383276 0.003306482maximum number of iterations reached 0.0009227438 0.0009145798maximum number of iterations reached 0.0009685509 0.0009612034maximum number of iterations reached 7.307863e-05 7.296627e-05maximum number of iterations reached 9.608019e-06 9.603682e-06maximum number of iterations reached 0.00350994 0.003419086maximum number of iterations reached 0.003526431 0.003451216maximum number of iterations reached 0.0005900797 0.0005861948maximum number of iterations reached 0.001023512 0.001016466maximum number of iterations reached 0.00016887 0.0001683069maximum number of iterations reached 0.0001299462 0.0001296232maximum number of iterations reached 0.004628318 0.004448631maximum number of iterations reached 0.004634033 0.004498265maximum number of iterations reached 0.004127251 0.00399254maximum number of iterations reached 0.004268406 0.004100832maximum number of iterations reached 0.004307604 0.004178833maximum number of iterations reached 0.005940607 0.005704337maximum number of iterations reached 0.004486243 0.004372647maximum number of iterations reached 0.005288184 0.005125229maximum number of iterations reached 0.0007264045 0.0007132683maximum number of iterations reached 0.005707646 0.005501502maximum number of iterations reached 0.005647897 0.005466536maximum number of iterations reached 0.004647044 0.0044943maximum number of iterations reached 0.005648132 0.005442088maximum number of iterations reached 0.003590092 0.003498139maximum number of iterations reached 0.005239744 0.005117408maximum number of iterations reached 0.004871161 0.004673662maximum number of iterations reached 0.003600565 0.003545737maximum number of iterations reached 0.0003939869 0.0003897127maximum number of iterations reached 0.004637818 0.004503884maximum number of iterations reached 0.001989047 0.001961685maximum number of iterations reached 0.004342224 0.004233405maximum number of iterations reached 0.006824139 0.006556443maximum number of iterations reached 0.005317471 0.005178164maximum number of iterations reached 0.005338886 0.005174974maximum number of iterations reached 0.006168195 0.005960786maximum number of iterations reached 0.005066535 0.004887109maximum number of iterations reached 0.004698824 0.004605208maximum number of iterations reached 0.005910105 0.005668707maximum number of iterations reached 0.001024593 0.001005003maximum number of iterations reached 0.003692151 0.003575736maximum number of iterations reached 0.004142732 0.003952489maximum number of iterations reached 0.004928929 0.004752158maximum number of iterations reached 0.00504845 0.004969715maximum number of iterations reached 0.004331088 0.004196365maximum number of iterations reached 0.003332295 0.003231759maximum number of iterations reached 0.003947351 0.003877125maximum number of iterations reached 0.003182628 0.003137876maximum number of iterations reached 0.005146356 0.005061825maximum number of iterations reached 0.00288411 0.002857716maximum number of iterations reached 0.0035519 0.003514456maximum number of iterations reached 0.005093095 0.004943651maximum number of iterations reached 0.004095498 0.003954424maximum number of iterations reached 0.005395354 0.005261712maximum number of iterations reached 0.004783995 0.004639392maximum number of iterations reached 0.004958268 0.004757902maximum number of iterations reached 0.006129676 0.005901674maximum number of iterations reached 0.0005806127 0.0005734658maximum number of iterations reached 0.001215181 0.001187187maximum number of iterations reached 0.002639932 0.002549952maximum number of iterations reached 0.005097216 0.004998366maximum number of iterations reached 0.002751339 0.002661829maximum number of iterations reached 0.004847287 0.004662299maximum number of iterations reached 0.004405007 0.00422952maximum number of iterations reached 0.001872224 0.001822333maximum number of iterations reached 0.004390983 0.004278945maximum number of iterations reached 0.003960717 0.003894789maximum number of iterations reached 0.005036813 0.004951428maximum number of iterations reached 0.004541112 0.00441611maximum number of iterations reached 0.004841924 0.004710746maximum number of iterations reached 0.004455929 0.004327162maximum number of iterations reached 0.0008705377 0.0008541455maximum number of iterations reached 0.005806576 0.005639732maximum number of iterations reached 0.002929816 0.002857133maximum number of iterations reached 0.005394513 0.005243147maximum number of iterations reached 0.006078505 0.005899297maximum number of iterations reached 0.005327874 0.005179517maximum number of iterations reached 0.00495068 0.004815956maximum number of iterations reached 0.003359465 0.003260125maximum number of iterations reached 0.0009084869 0.0008987959maximum number of iterations reached 0.005410964 0.005216578maximum number of iterations reached 0.003995497 0.003878281maximum number of iterations reached 0.001606628 0.001562465maximum number of iterations reached 0.005636473 0.005441771maximum number of iterations reached 0.005227039 0.005071568maximum number of iterations reached 0.000258769 0.0002568537maximum number of iterations reached 0.004842971 0.004763221maximum number of iterations reached 0.005331359 0.005178806maximum number of iterations reached 0.00542259 0.005280969maximum number of iterations reached 0.001458637 0.001429968maximum number of iterations reached 0.00601862 0.005851172maximum number of iterations reached 0.004902334 0.004798182maximum number of iterations reached 0.004529015 0.004401757maximum number of iterations reached 0.0009172858 0.0009063744maximum number of iterations reached 0.004847903 0.004689284maximum number of iterations reached 0.004360676 0.0042486maximum number of iterations reached 0.003324662 0.003242204maximum number of iterations reached 0.001464561 0.001443714maximum number of iterations reached 0.001033011 0.001023307maximum number of iterations reached 0.0009268671 0.0009197011maximum number of iterations reached 8.665011e-05 8.650343e-05maximum number of iterations reached 0.0001225908 0.0001223146maximum number of iterations reached 9.74391e-06 9.73666e-06maximum number of iterations reached 0.005152278 0.005047222maximum number of iterations reached 0.00499369 0.004830594maximum number of iterations reached 0.004152008 0.004049453maximum number of iterations reached 0.005287496 0.005171325maximum number of iterations reached 0.005109311 0.004930005maximum number of iterations reached 0.0005055498 0.0004999528maximum number of iterations reached 0.00458494 0.004464952maximum number of iterations reached 0.00495352 0.004835171maximum number of iterations reached 0.004207889 0.004112157maximum number of iterations reached 0.002950762 0.002885037maximum number of iterations reached 0.001654825 0.001630094maximum number of iterations reached 0.001337844 0.001323749maximum number of iterations reached 0.0003622451 0.0003605897maximum number of iterations reached 0.004783391 0.004650937maximum number of iterations reached 0.004149116 0.004032517maximum number of iterations reached 0.00113044 0.001116271maximum number of iterations reached 0.002399862 0.00235179maximum number of iterations reached 0.0007783997 0.0007713115maximum number of iterations reached 0.00118968 0.001170661maximum number of iterations reached 0.0007365922 0.0007296812maximum number of iterations reached 0.000161282 0.0001606421maximum number of iterations reached 3.293627e-05 3.29065e-05maximum number of iterations reached 0.0003398764 0.0003384034maximum number of iterations reached 4.472013e-05 4.466886e-05maximum number of iterations reached 3.791638e-05 3.788469e-05maximum number of iterations reached 0.002607029 0.002514547maximum number of iterations reached 0.003030888 0.002913387maximum number of iterations reached 0.003231114 0.003097359maximum number of iterations reached 0.006651955 0.006371491maximum number of iterations reached 0.005969018 0.005688097maximum number of iterations reached 0.001328722 0.00129637maximum number of iterations reached 0.005721035 0.005489382maximum number of iterations reached 0.001810472 0.001761187maximum number of iterations reached 0.0009419104 0.0009252147maximum number of iterations reached 0.004418726 0.004253658maximum number of iterations reached 0.005813873 0.005595033maximum number of iterations reached 0.004605666 0.004499689maximum number of iterations reached 0.004618039 0.004513099maximum number of iterations reached 0.001566155 0.001525988maximum number of iterations reached 0.005299484 0.005076638maximum number of iterations reached 0.003495508 0.003391064maximum number of iterations reached 0.005482257 0.00523561maximum number of iterations reached 0.006634183 0.006302033maximum number of iterations reached 0.0001764638 0.0001757201maximum number of iterations reached 0.004783983 0.004576417maximum number of iterations reached 0.001370267 0.001344296maximum number of iterations reached 0.005937459 0.005744799maximum number of iterations reached 0.0007274602 0.0007158651maximum number of iterations reached 0.0060579 0.005814985maximum number of iterations reached 0.00501939 0.004816078maximum number of iterations reached 0.002345828 0.00226481maximum number of iterations reached 0.0001040479 0.0001037016maximum number of iterations reached 0.003355734 0.003249229maximum number of iterations reached 0.005266616 0.005158722maximum number of iterations reached 0.005629593 0.005474229maximum number of iterations reached 0.004181632 0.004130111maximum number of iterations reached 0.006194256 0.006010146maximum number of iterations reached 0.001401053 0.001373085maximum number of iterations reached 0.005343432 0.005174899maximum number of iterations reached 0.0004595331 0.0004573071maximum number of iterations reached 0.0001623252 0.0001614673maximum number of iterations reached 5.766471e-05 5.755652e-05maximum number of iterations reached 0.0001595893 0.00015884maximum number of iterations reached 0.0002580717 0.0002567466maximum number of iterations reached 0.00509044 0.004877287maximum number of iterations reached 0.002945571 0.002863239maximum number of iterations reached 0.004681201 0.004545005maximum number of iterations reached 0.003678893 0.003574389maximum number of iterations reached 0.004943843 0.004850116maximum number of iterations reached 0.006004777 0.00584337maximum number of iterations reached 0.00341239 0.003320232maximum number of iterations reached 0.005185119 0.005021267maximum number of iterations reached 0.005975478 0.005802451maximum number of iterations reached 0.005429477 0.005279342maximum number of iterations reached 0.002825172 0.002785039maximum number of iterations reached 0.004856197 0.004726454maximum number of iterations reached 0.003384086 0.003325918maximum number of iterations reached 0.0003217067 0.0003200253maximum number of iterations reached 0.0007550785 0.0007449235maximum number of iterations reached 0.005128509 0.004949188maximum number of iterations reached 0.00528585 0.005137697maximum number of iterations reached 0.004210757 0.004050848maximum number of iterations reached 0.004843311 0.00473298maximum number of iterations reached 0.005668745 0.005497408maximum number of iterations reached 0.006228242 0.006045303maximum number of iterations reached 0.002633863 0.002556062maximum number of iterations reached 0.001372392 0.001352015maximum number of iterations reached 0.004820837 0.004691779maximum number of iterations reached 0.005339459 0.005204956maximum number of iterations reached 0.00529715 0.005174456maximum number of iterations reached 0.003394561 0.003318728maximum number of iterations reached 0.001412603 0.001394812maximum number of iterations reached 0.001198586 0.001185618maximum number of iterations reached 1.794449e-05 1.793164e-05maximum number of iterations reached 3.384354e-05 3.381559e-05maximum number of iterations reached 0.005332382 0.005229311maximum number of iterations reached 0.002615414 0.002555247maximum number of iterations reached 0.0008291574 0.0008202699maximum number of iterations reached 0.00523753 0.005123617maximum number of iterations reached 0.002913179 0.002867963maximum number of iterations reached 0.000345374 0.0003435967maximum number of iterations reached 0.001599897 0.001583658maximum number of iterations reached 0.0003550157 0.0003544246maximum number of iterations reached 2.756207e-05 2.754156e-05maximum number of iterations reached 0.0001754067 0.0001747496maximum number of iterations reached 0.003330068 0.003265889maximum number of iterations reached 0.002523862 0.002484114maximum number of iterations reached 0.00115405 0.001145504maximum number of iterations reached 0.0001493794 0.0001490634maximum number of iterations reached 5.507752e-05 5.502951e-05maximum number of iterations reached 0.001756343 0.001725365maximum number of iterations reached 0.0009328492 0.0009174415maximum number of iterations reached 0.0001253702 0.0001248946maximum number of iterations reached 0.0004785419 0.0004734486maximum number of iterations reached 0.001018324 0.0009995997maximum number of iterations reached 3.346657e-05 3.341468e-05maximum number of iterations reached 0.00139296 0.001365058maximum number of iterations reached 1.761419e-05 1.759892e-05maximum number of iterations reached 2.206091e-05 2.204408e-05maximum number of iterations reached 0.0002152863 0.0002139913maximum number of iterations reached 6.282356e-05 6.26674e-05maximum number of iterations reached 0.003096838 0.002999754maximum number of iterations reached 5.325515e-05 5.318703e-05maximum number of iterations reached 0.0002228476 0.0002219415maximum number of iterations reached 0.000106454 0.0001061568line search fails -0.228168 0.9143434 1.161165e-05 -4.906731e-06 -2.506566e-08 2.324093e-08 -4.050907e-13maximum number of iterations reached 0.004383522 0.004197204maximum number of iterations reached 0.002544549 0.002449788maximum number of iterations reached 0.002575629 0.002494046maximum number of iterations reached 0.004410523 0.00422801maximum number of iterations reached 0.002672706 0.002580807maximum number of iterations reached 0.003967165 0.003807886maximum number of iterations reached 0.005836068 0.005592295maximum number of iterations reached 0.005001843 0.004846251maximum number of iterations reached 0.004820248 0.004625868maximum number of iterations reached 0.005365745 0.005131083maximum number of iterations reached 0.000408397 0.0004043118maximum number of iterations reached 0.005363157 0.005158823maximum number of iterations reached 0.006079706 0.005876258maximum number of iterations reached 0.005974109 0.005776673maximum number of iterations reached 0.005605525 0.005383297maximum number of iterations reached 0.0007809112 0.0007697284maximum number of iterations reached 0.003612315 0.003473744maximum number of iterations reached 0.005107945 0.004882824maximum number of iterations reached 0.005659362 0.005395984maximum number of iterations reached 0.001001188 0.0009821058maximum number of iterations reached 0.003497327 0.003343599maximum number of iterations reached 1.209799e-05 1.209035e-05maximum number of iterations reached 2.809637e-05 2.805361e-05maximum number of iterations reached 0.0005571524 0.000549749maximum number of iterations reached 0.004306941 0.004152308maximum number of iterations reached 0.002880104 0.002788547maximum number of iterations reached 1.991223e-05 1.989304e-05maximum number of iterations reached 0.001973082 0.001920734maximum number of iterations reached 0.006038505 0.00591274maximum number of iterations reached 0.006432191 0.006186025maximum number of iterations reached 0.003422958 0.003354701maximum number of iterations reached 0.005922694 0.005724361maximum number of iterations reached 0.001819595 0.001787238maximum number of iterations reached 0.00538137 0.005148418maximum number of iterations reached 0.004929229 0.004719557maximum number of iterations reached 3.10197e-05 3.097278e-05maximum number of iterations reached 0.004625029 0.004401508maximum number of iterations reached 0.002085146 0.002028975maximum number of iterations reached 0.002613303 0.002543808maximum number of iterations reached 0.003516737 0.003394098maximum number of iterations reached 0.004141839 0.004012961maximum number of iterations reached 0.004327336 0.004182154maximum number of iterations reached 0.004180687 0.004038265maximum number of iterations reached 0.005085178 0.004925563maximum number of iterations reached 0.005684114 0.005521997maximum number of iterations reached 0.004537048 0.004430387maximum number of iterations reached 0.006155533 0.005972786maximum number of iterations reached 0.001222911 0.001203128maximum number of iterations reached 0.003529363 0.003467109maximum number of iterations reached 0.0002958413 0.0002946089maximum number of iterations reached 0.0002204218 0.000219654maximum number of iterations reached 0.004203946 0.004036048maximum number of iterations reached 0.001731871 0.001687396maximum number of iterations reached 0.001135314 0.001115006maximum number of iterations reached 0.00455422 0.004420971maximum number of iterations reached 0.002917034 0.00285779maximum number of iterations reached 0.002479778 0.002434521maximum number of iterations reached 0.00565824 0.005430409maximum number of iterations reached 0.001936788 0.001898564maximum number of iterations reached 0.005640233 0.005484279maximum number of iterations reached 0.005140963 0.004999774maximum number of iterations reached 0.006389833 0.006196303maximum number of iterations reached 0.002536965 0.002495912maximum number of iterations reached 0.003520533 0.003458537maximum number of iterations reached 0.00264593 0.002603502maximum number of iterations reached 8.456744e-05 8.441628e-05maximum number of iterations reached 3.671909e-05 3.669268e-05maximum number of iterations reached 5.544112e-05 5.538661e-05maximum number of iterations reached 0.006991796 0.006725001maximum number of iterations reached 0.004356777 0.00426231maximum number of iterations reached 0.0009587339 0.0009487946maximum number of iterations reached 0.003183072 0.003125916maximum number of iterations reached 0.001323688 0.001314826maximum number of iterations reached 0.0009559479 0.0009459595maximum number of iterations reached 5.667021e-05 5.657788e-05maximum number of iterations reached 6.59056e-05 6.581657e-05maximum number of iterations reached 0.00376811 0.003681087maximum number of iterations reached 0.002587758 0.002557981maximum number of iterations reached 0.002857622 0.002821293maximum number of iterations reached 0.000200451 0.0001996719maximum number of iterations reached 0.0001171114 0.0001169127maximum number of iterations reached 0.004558723 0.004351885maximum number of iterations reached 0.002009024 0.00194126maximum number of iterations reached 0.000842104 0.0008304313maximum number of iterations reached 0.001039834 0.001026262maximum number of iterations reached 0.001731332 0.001694447maximum number of iterations reached 0.002450767 0.002373956maximum number of iterations reached 0.002514853 0.002437272maximum number of iterations reached 0.001538051 0.001500465maximum number of iterations reached 0.002922209 0.002844848maximum number of iterations reached 0.00463118 0.004433206maximum number of iterations reached 0.005766725 0.005505156maximum number of iterations reached 0.0003354564 0.0003333934maximum number of iterations reached 0.00342872 0.003277041maximum number of iterations reached 0.003132071 0.003018825maximum number of iterations reached 0.0006977819 0.00068888maximum number of iterations reached 0.001312627 0.001281026maximum number of iterations reached 0.003026857 0.002928766maximum number of iterations reached 0.003700226 0.003560295maximum number of iterations reached 7.493535e-05 7.474231e-05maximum number of iterations reached 0.001544486 0.001523358maximum number of iterations reached 0.004322122 0.004175574maximum number of iterations reached 0.001973376 0.001933003maximum number of iterations reached 1.682064e-05 1.680434e-05maximum number of iterations reached 0.004740271 0.004556512maximum number of iterations reached 0.000522407 0.0005190283maximum number of iterations reached 0.001913402 0.001860882maximum number of iterations reached 0.005198113 0.004991459maximum number of iterations reached 0.001427615 0.001403402maximum number of iterations reached 0.003910603 0.003801416maximum number of iterations reached 0.003774362 0.0036808maximum number of iterations reached 0.003697243 0.003604009maximum number of iterations reached 0.002514786 0.002470049maximum number of iterations reached 0.0002160116 0.0002154518maximum number of iterations reached 0.003934008 0.003780009maximum number of iterations reached 0.0008672746 0.0008546849maximum number of iterations reached 0.002265455 0.002208444maximum number of iterations reached 0.001997133 0.0019417maximum number of iterations reached 0.002299914 0.002234701maximum number of iterations reached 8.543019e-05 8.522583e-05maximum number of iterations reached 0.002030076 0.001992727maximum number of iterations reached 0.0004735751 0.0004715831maximum number of iterations reached 6.953633e-05 6.942211e-05maximum number of iterations reached 0.004285119 0.004154054maximum number of iterations reached 0.001706551 0.001680037maximum number of iterations reached 0.004058204 0.003968283maximum number of iterations reached 0.0004256137 0.0004241842maximum number of iterations reached 2.401127e-05 2.399473e-05maximum number of iterations reached 0.0006801103 0.0006754921maximum number of iterations reached 0.0009949519 0.0009873202maximum number of iterations reached 0.001924099 0.001868373maximum number of iterations reached 0.000273329 0.0002706255maximum number of iterations reached 0.005476153 0.005226674maximum number of iterations reached 0.004283692 0.004118256maximum number of iterations reached 0.003550582 0.003416096maximum number of iterations reached 0.003235965 0.003110714maximum number of iterations reached 0.005610234 0.005421097maximum number of iterations reached 0.005580908 0.005340823maximum number of iterations reached 0.005696933 0.005485012maximum number of iterations reached 0.001778572 0.001730809maximum number of iterations reached 0.006639848 0.006377896maximum number of iterations reached 0.002941211 0.002837665maximum number of iterations reached 0.002702351 0.002606986maximum number of iterations reached 0.004709256 0.004537902maximum number of iterations reached 0.003801067 0.003718613maximum number of iterations reached 0.004549188 0.004465806maximum number of iterations reached 1.966067e-05 1.963658e-05maximum number of iterations reached 0.00426318 0.004204011maximum number of iterations reached 0.005096869 0.004960509maximum number of iterations reached 0.004396122 0.004245304maximum number of iterations reached 0.005493394 0.005323007maximum number of iterations reached 0.005223995 0.005045588maximum number of iterations reached 0.006036512 0.005776901maximum number of iterations reached 0.006304059 0.006072887maximum number of iterations reached 0.003775602 0.003634994maximum number of iterations reached 0.003983079 0.003850293maximum number of iterations reached 0.001547548 0.001514065maximum number of iterations reached 3.374111e-05 3.36928e-05maximum number of iterations reached 0.00672962 0.006486884maximum number of iterations reached 0.002975059 0.002865849maximum number of iterations reached 0.002135304 0.00207572maximum number of iterations reached 0.004839415 0.004703676maximum number of iterations reached 0.004678823 0.004522969maximum number of iterations reached 0.002613725 0.002535239maximum number of iterations reached 0.005451082 0.005280603maximum number of iterations reached 0.003006734 0.002921012maximum number of iterations reached 0.005339352 0.005174925maximum number of iterations reached 0.003090794 0.003000748maximum number of iterations reached 0.005370912 0.005237793maximum number of iterations reached 0.0009283576 0.0009142758maximum number of iterations reached 0.006521668 0.006321497maximum number of iterations reached 0.004308905 0.004167956maximum number of iterations reached 0.0004384504 0.0004330498maximum number of iterations reached 0.005496819 0.005318093maximum number of iterations reached 0.002430807 0.002345051maximum number of iterations reached 2.955962e-05 2.951149e-05maximum number of iterations reached 0.00492926 0.00480267maximum number of iterations reached 0.004959125 0.004794768maximum number of iterations reached 0.004618388 0.004439371maximum number of iterations reached 0.001624129 0.001581625maximum number of iterations reached 0.003909227 0.003855514maximum number of iterations reached 0.00514577 0.005005952maximum number of iterations reached 0.005390643 0.005247152maximum number of iterations reached 0.006453329 0.006272957maximum number of iterations reached 0.006086963 0.005919222maximum number of iterations reached 0.006516492 0.006322444maximum number of iterations reached 0.00106637 0.001055186maximum number of iterations reached 0.001629156 0.001606556maximum number of iterations reached 0.0004491069 0.0004463823maximum number of iterations reached 0.005212164 0.005012877maximum number of iterations reached 0.005778814 0.005566837maximum number of iterations reached 0.005181 0.005068623maximum number of iterations reached 0.00390663 0.00376358maximum number of iterations reached 0.003398779 0.00331465maximum number of iterations reached 0.004778155 0.004602197maximum number of iterations reached 0.005789232 0.005658218maximum number of iterations reached 0.0001812842 0.0001804783maximum number of iterations reached 0.005860104 0.005713154maximum number of iterations reached 0.00431277 0.004205331maximum number of iterations reached 0.004009487 0.003902228maximum number of iterations reached 0.003024306 0.002945918maximum number of iterations reached 0.00327405 0.003225425maximum number of iterations reached 0.001919732 0.001894547maximum number of iterations reached 0.001214808 0.001197498maximum number of iterations reached 0.000624818 0.000620299maximum number of iterations reached 0.0003052319 0.0003040362maximum number of iterations reached 0.006267009 0.00604662maximum number of iterations reached 0.005262215 0.005149179maximum number of iterations reached 0.006146385 0.005994093maximum number of iterations reached 0.005575169 0.005427249maximum number of iterations reached 0.004814996 0.004689674maximum number of iterations reached 0.003333348 0.003260956maximum number of iterations reached 0.002406078 0.002362063maximum number of iterations reached 0.002813572 0.00276726maximum number of iterations reached 0.0005546911 0.0005504204maximum number of iterations reached 0.0007231643 0.0007172636maximum number of iterations reached 0.0004709674 0.0004687692maximum number of iterations reached 7.151027e-05 7.140471e-05maximum number of iterations reached 1.071984e-05 1.071327e-05maximum number of iterations reached 0.004722217 0.00459893maximum number of iterations reached 0.005215749 0.005086569maximum number of iterations reached 0.001154009 0.001145445maximum number of iterations reached 0.001564924 0.001546112maximum number of iterations reached 0.000732014 0.0007265943maximum number of iterations reached 1.497625e-05 1.496519e-05maximum number of iterations reached 2.396731e-05 2.394429e-05maximum number of iterations reached 4.491611e-05 4.486277e-05</code></pre>
<pre class="r"><code>plot(svmr.fit2, highlight = TRUE, par.settings = myPar)</code></pre>
<p><img src="vaccine_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="model-selection" class="section level1">
<h1><strong>Model selection</strong></h1>
<pre class="r"><code>#*scaled, centered &amp; box cox transformation*
resamp = resamples(list(svmr2= svmr.fit2, 
                        boosting2= gbmA.fit2,
                        pls = pls_fit,
                        enet2= enet.fit2,
                        lda2 = model.lda2,
                        logistic2= log.fit2, 
                        logistic3= log.fit3)) # Pca logistic 
#summary(resamp)
bwplot(resamp)</code></pre>
<p><img src="vaccine_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>To compare the models, the resamples function was applied since the
same CV and data preprocessing was applied to each model. The model with
the highest median ROC on the training data was logistic regression
(0.738). All models had similarly high sensitivity, the ability to
correctly identify severe flu cases, and low specificity, indicating
limited ability to correctly classify non-severe cases. The logistic
regression had a specificity of 0.21 and sensitivity of 0.95. Although
the elastic net model, which behaved more like a ridge regression (α =
0), achieved the highest mean ROC (0.710), it did not have the highest
median ROC, suggesting less consistent performance across folds.</p>
<p>Across many models, variables such as bmi, weight, and height were
highly correlated. PCA was applied to the final model as an attempt to
reduce the differences in variances, but did not improve the model on
the training data (log.fit3). The final model did not use PCA as it did
not improve generalizability, so to preserve interpretability, simple
logistic regression was used. Therefore, the final model of logistic
regression trained on the preprocessed data was selected based on the
lowest median ROC selection criteria. Thus, advanced methods such as
boosting and SVM did not outperform simpler logistic regression,
suggesting limited benefit from more complex models in this dataset.</p>
</div>
<div id="results" class="section level1">
<h1><strong>Results</strong></h1>
<p>The odds ratio of flu severity is e^0.51= 1.66 among males (p=
0.0077) compared to females, holding all other variables fixed. This
result is statistically significant. The odds ratio of flu severity is
1.2 among Asian individuals, lower among Black individuals, and 1.5
times higher among Hispanic individuals compared to white individuals.
The OR of flu severity among former smokers is 0.25 lower compared to
those who never smoked and 1.93 times higher among current smokers (p=
0.029). Each additional year of age was associated with a 3% decrease in
the odds of severe flu (OR = exp(-0.126) = 0.88), but this was not
statistically significant (p = 0.2402). Each unit increase in BMI is
associated with 2.18 higher OR of experiencing a severe flu, holding all
variable fixed (p &lt;0.001). Those who have diabetes had 1.66 times the
odds of experiencing severe flu compared to those who do not have
diabetes (p= 0.053). The OR of flu severity among those with
hypertension was 1.46 higher than those who do not have hypertension (p
= 0.23). Each unit increase in Systolic blood pressure was associated
with 1.07 times the odds of flu severity (p= 0.68). Each unit increase
in LDL cholesterol levels was associated with 1.16 times the odds of flu
severity while holding all other variables fixed (p= 0.11). The only
coefficients which were found to be significant with the outcome of flu
severity was gender (Male), smoking status (Current), and BMI. These
results suggest that BMI, gender, and smoking status are the most
relevant predictors in this dataset, while many clinical variables such
as SBP and LDL had low predictive information. By inputting individual
participant values for variables such as age, gender, race, smoking
status, and other health conditions, the logistic regression equation
produces a probability that quantifies the risk of experiencing severe
flu.</p>
<p>The final model had lower test performance (ROC= 0.68) compared to
the training performance (ROC = 0.738). The model may have had poor
generalizability due to differences in distributions of continuous
predictors in training and testing data. Variable importance plots of
models and optimal number of components also suggested that many of
these predictors were not significant in explaining the variance of
outcome.</p>
<p>The final model had a kappa value of 0.2 and accuracy of 0.75 which
suggests the model has poor observed and expected agreement. Values of
kappa close to 0 suggest the models are uncorrelated and classification
is not meaningful in the data.</p>
<p>Boosting and SVM models did not perform better on the training data.
This was likely due to the classes not being nearly separable and
overlapping substantially, so SVM performed poor compared to logistic
regression. Boosting did not perform well even when highly correlated
variables were excluded from the train function. Overall, the predictor
variables in this data may not have been truly informative of the
outcome of flu severity 6-months post-vaccination evident of low
importance among majority of predictors.</p>
<p>Figure 12. Resampling Cross-Validation Model Comparison</p>
<pre class="r"><code># Predict probabilities for the &quot;Yes&quot; class (severe flu)
test.pred.prob = predict(log.fit2, newdata = testData_pp, type = &quot;prob&quot;)[, &quot;Yes&quot;]

test.pred = ifelse(test.pred.prob &gt; 0.5, &quot;Yes&quot;, &quot;No&quot;)

confusion_table= confusionMatrix(data = factor(test.pred, levels = c(&quot;No&quot;, &quot;Yes&quot;)),
                reference = testData_pp$severe_flu,
                positive = &quot;Yes&quot;)

roc.glm = roc(testData_pp$severe_flu, test.pred.prob)</code></pre>
<pre><code>## Setting levels: control = No, case = Yes</code></pre>
<pre><code>## Setting direction: controls &lt; cases</code></pre>
<pre class="r"><code># ROC curve
plot(roc.glm, legacy.axes = TRUE, print.auc = TRUE)</code></pre>
<p><img src="vaccine_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
<div id="appendix" class="section level1">
<h1><strong>Appendix</strong></h1>
<figure style="text-align: center;">
<figcaption style="font-size: 14px; color: #555; margin-top: 5px;">
Figure 1. Density plots of the distribution of continuous variables
across the outcome of flu severity in the Training data
</figcaption>
</figure>
<pre class="r"><code>par(mfrow = c(2, 4))  

cont_pred = c(&quot;age&quot;, &quot;height&quot;, &quot;weight&quot;, &quot;bmi&quot;, &quot;SBP&quot;, &quot;LDL&quot;)
plot_list = list()

# Loop over each variable
for (var in cont_pred) {
  p = ggplot(training_data, aes_string(x = &quot;severe_flu&quot;, y = var)) +
    geom_violin(trim = FALSE) +
    geom_boxplot(width = 0.1, outlier.shape = NA) 
  
  plot_list[[var]] = p
}

wrap_plots(plot_list, ncol = 3)</code></pre>
<p><img src="vaccine_files/figure-html/unnamed-chunk-16-1.png" width="960" /></p>
<figure style="text-align: center;">
<figcaption style="font-size: 14px; color: #555; margin-top: 5px;">
Figure 2. Density plots of the distribution of continuous variables
across the outcome of flu severity in the Testing data
</figcaption>
</figure>
<pre class="r"><code>for (var in cont_pred) {
  p = ggplot(testing_data, aes_string(x = &quot;severe_flu&quot;, y = var)) +
    geom_violin(trim = FALSE) +
    geom_boxplot(width = 0.1, outlier.shape = NA) 
  
  plot_list[[var]] = p
}

wrap_plots(plot_list, ncol = 3)</code></pre>
<p><img src="vaccine_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<figure style="text-align: center;">
<figcaption style="font-size: 14px; color: #555; margin-top: 5px;">
Figure 3. Correlation heatmap of continuous predictors across the flu
severity status
</figcaption>
</figure>
<pre class="r"><code>#for no severe_flu group
dat_0= dat|&gt;
  filter(severe_flu == &quot;Yes&quot;)
cor_data_0=  dat_0[cont_pred]
cor_matrix_0= cor(cor_data_0)

# for severe_flu group
dat_1= dat|&gt;
  filter(severe_flu == &quot;No&quot;)
cor_data_1 = dat_1[cont_pred]
cor_matrix_1= cor(cor_data_1)

corr_0= ggcorrplot(cor_matrix_0,
           hc.order = TRUE,
           type = &quot;lower&quot;,
           lab = TRUE,
           colors = c(&quot;red&quot;, &quot;white&quot;, &quot;blue&quot;),
           ggtheme = theme_minimal())

corr_1= ggcorrplot(cor_matrix_1,
           hc.order = TRUE,
           type = &quot;lower&quot;,
           lab = TRUE,
           colors = c(&quot;red&quot;, &quot;white&quot;, &quot;blue&quot;),
           ggtheme = theme_minimal())

corr_0+corr_1</code></pre>
<p><img src="vaccine_files/figure-html/unnamed-chunk-18-1.png" width="960" /></p>
<figure style="text-align: center;">
<figcaption style="font-size: 14px; color: #555; margin-top: 5px;">
Figure 4. Bar plots of discrete predictors across flu severity status
</figcaption>
</figure>
<pre class="r"><code>cat_pred = c(&quot;race&quot;, &quot;smoking&quot;, &quot;diabetes&quot;, &quot;hypertension&quot;)
plot_list = list()

for (var in cat_pred) {
  p = ggplot(dat, aes(x = .data[[var]], fill = factor(severe_flu))) +
    geom_bar(position = &quot;fill&quot;) +
    labs(x = var, y = &quot;Proportion&quot;, fill = &quot;Severe Flu&quot;) +
    theme_minimal()
  
  plot_list[[var]] = p
}

wrap_plots(plot_list, ncol = 2)</code></pre>
<p><img src="vaccine_files/figure-html/unnamed-chunk-19-1.png" width="960" /></p>
<figure style="text-align: center;">
<figcaption style="font-size: 14px; color: #555; margin-top: 5px;">
Figure 5. Principle Component Analysis – Biplot of PC1 and PC2 across
flu severity
</figcaption>
</figure>
<pre class="r"><code>#biplot
train_numeric= trainData_pp |&gt; 
              dplyr::select(where(is.numeric))

pca.fit = prcomp(train_numeric)
fviz_pca_biplot(pca.fit, 
                axes = c(1,2),
                habillage = trainData_pp$severe_flu, 
                addEllipses = TRUE ,
                label = &quot;none&quot;)</code></pre>
<p><img src="vaccine_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
